{
  "kind": "build_request",
  "title": "Add comprehensive profile system with photos and enhanced review photo uploads",
  "projectName": "Baitoo",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-24",
      "text": "Add profile photo field to backend User type and implement uploadProfilePhoto and updateUserProfile functions to handle profile photo storage and user profile updates including name and phone",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "Profile photo upload option",
          "Both Salon Owner and Customer must have: Profile photo upload option, Edit profile option, Save changes button"
        ]
      },
      "acceptanceCriteria": [
        "User type includes optional profilePhoto field for storing image data or reference",
        "uploadProfilePhoto function accepts user principal and photo data and stores it securely",
        "updateUserProfile function allows updating name, phone, and profile photo",
        "Photo data is stored efficiently and retrievable by principal"
      ]
    },
    {
      "id": "REQ-25",
      "text": "Add photo upload field to Review type in backend and update submitReview function to accept and store optional review photos submitted by customers",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "When a customer gives a review, they should have: Star rating (1 to 5), Text review, Option to upload photo (example: haircut result photo)"
        ]
      },
      "acceptanceCriteria": [
        "Review type includes optional photos field (array or single photo reference)",
        "submitReview function accepts optional photo data along with rating and text",
        "Photos are stored securely and associated with the review record",
        "getReviewsForSalon function returns reviews with photo data included"
      ]
    },
    {
      "id": "REQ-26",
      "text": "Remove ProfileSetupModal from displaying as the main screen after registration and profile creation, ensuring users are redirected to their appropriate dashboard (salon owner or customer) instead of staying on the profile setup page",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "After registration and profile creation, the profile page should not stay open as main screen"
        ]
      },
      "acceptanceCriteria": [
        "After completing ProfileSetupModal, users are automatically redirected to their dashboard",
        "Salon owners land on their salon management dashboard",
        "Customers land on the salon discovery page",
        "Profile setup modal does not remain visible after completion"
      ]
    },
    {
      "id": "REQ-27",
      "text": "Add a small profile icon in the top-right corner of the AppLayout header that is always visible for authenticated users and opens the user's profile page when clicked",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "A small profile icon should appear in the top-right corner of the app",
          "When user clicks the profile icon, their profile page should open"
        ]
      },
      "acceptanceCriteria": [
        "Profile icon appears in header next to notification bell for authenticated users",
        "Icon is consistently positioned in top-right corner across all pages",
        "Clicking icon navigates to appropriate profile page based on user type",
        "Icon uses a standard user avatar or profile symbol"
      ]
    },
    {
      "id": "REQ-28",
      "text": "Create a comprehensive salon owner profile page that displays and allows editing of profile photo, salon name, address, contact number, opening hours with a save changes button, and includes an image upload component supporting gallery and camera access",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "Salon Owner Profile Should Include: Profile photo (shop logo or owner photo), Salon name, Address, Contact number, Opening hours, Edit option",
          "Image upload should support gallery and camera"
        ]
      },
      "acceptanceCriteria": [
        "Profile page displays current profile photo with upload/change option",
        "Form fields for salon name, address, contact number, and opening hours are editable",
        "Image upload component supports both gallery selection and camera capture",
        "Save changes button calls backend to update profile with new data",
        "Profile photo is displayed as a preview after upload before saving",
        "Success message shown after successful profile update"
      ]
    },
    {
      "id": "REQ-29",
      "text": "Create a comprehensive customer profile page that displays and allows editing of profile photo, name, phone number, with a save changes button, displays booking history with past and upcoming bookings, and includes an image upload component supporting gallery and camera access",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "Customer Profile Should Include: Profile photo, Name, Phone number, Booking history, Edit option",
          "Image upload should support gallery and camera"
        ]
      },
      "acceptanceCriteria": [
        "Profile page displays current profile photo with upload/change option",
        "Form fields for name and phone number are editable",
        "Image upload component supports both gallery selection and camera capture",
        "Booking history section shows list of past and upcoming bookings with status",
        "Save changes button calls backend to update profile with new data",
        "Profile photo is displayed as a preview after upload before saving",
        "Success message shown after successful profile update"
      ]
    },
    {
      "id": "REQ-30",
      "text": "Update CustomerBookingsPage review submission dialog to include a photo upload option allowing customers to upload photos of their haircut results, supporting gallery and camera access, and send the photo data along with rating and text to the backend submitReview function",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "When a customer gives a review, they should have: Star rating (1 to 5), Text review, Option to upload photo (example: haircut result photo)",
          "Image upload should support gallery and camera"
        ]
      },
      "acceptanceCriteria": [
        "Review dialog includes photo upload button below text review field",
        "Photo upload component supports gallery selection and camera capture",
        "Selected photo is previewed in the dialog before submission",
        "submitReview mutation sends photo data along with rating and text",
        "Photo upload is optional and review can be submitted without photo",
        "Clear indication when photo is selected and option to remove it before submission"
      ]
    },
    {
      "id": "REQ-31",
      "text": "Update SalonDetailPage reviews section to display customer review photos alongside ratings and text reviews, showing photo thumbnails that can be clicked to view full size",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "Uploaded review photos should be visible under salon reviews section"
        ]
      },
      "acceptanceCriteria": [
        "Review cards display photo thumbnails when photos are present",
        "Photos are shown below or alongside review text",
        "Clicking a photo thumbnail opens a larger view or modal",
        "Reviews without photos display normally without photo placeholder",
        "Multiple photos per review are supported if backend allows",
        "Photo loading states and error handling are implemented"
      ]
    },
    {
      "id": "REQ-32",
      "text": "Add a reviews section to the salon owner dashboard that displays all reviews for the salon including star ratings, text reviews, customer names, and uploaded review photos with photo viewing capability",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "Salon owner should be able to view all reviews inside dashboard"
        ]
      },
      "acceptanceCriteria": [
        "Dashboard includes a reviews tab or section showing all salon reviews",
        "Each review displays customer name, rating stars, text, and timestamp",
        "Review photos are displayed as thumbnails with click-to-enlarge functionality",
        "Reviews are sorted by date (newest first)",
        "Empty state shown when no reviews exist",
        "Reviews section is easily accessible from main dashboard navigation"
      ]
    }
  ],
  "constraints": [
    "Do not modify useInternetIdentity.ts, useInternetIdentity.tsx, useActor.ts, main.tsx, or components/ui directory",
    "Maintain single-actor backend architecture with all logic in main.mo",
    "Profile photos and review photos must be stored securely in the backend",
    "Image upload must work on mobile devices with gallery and camera access",
    "Keep the system lightweight and suitable for MVP launch"
  ],
  "nonGoals": [
    "Advanced photo editing features or filters",
    "Cloud storage integration for images (store in backend)",
    "Social media sharing of reviews or photos",
    "Video upload capability",
    "Bulk photo uploads",
    "Photo gallery management beyond basic upload and display"
  ],
  "imageRequirements": {
    "required": [
      "Simple user profile avatar icon for header, circular silhouette design (profile-icon.dim_40x40.png)"
    ],
    "edits": []
  }
}